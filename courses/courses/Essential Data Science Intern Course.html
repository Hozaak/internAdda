<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Essential Data Science Intern Course ‚Äî Internadda</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="../../style.css">
    <style>
        /* FIX: Ensure body takes up vertical space for spinner */
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        main {
             flex-grow: 1;
             position: relative;
        }

        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* FIX: Loading Overlay Styles */
        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 1);
            z-index: 2000; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease-in-out;
        }
        .spinner-large {
            border: 6px solid #f3f3f3;
            border-top: 6px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1.5s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #loadingText {
             margin-top: 20px;
             font-size: 1.1rem;
             color: var(--dark);
        }
        /* End Loading Fix */


        /* FIX: Main content container starts hidden */
        .main-content-container {
            max-width: 800px;
            margin: 0 auto;
            min-height: 500px; 
            opacity: 0; 
            transition: opacity 0.4s ease-in-out;
            position: relative; 
        }
        
        /* Class added by JS once auth state is confirmed */
        .content-loaded {
            opacity: 1 !important;
        }

        .hidden {
            display: none !important;
        }

        /* --- Course Content Styles --- */

        .course-title-main {
            font-size: 2.8rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 20px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .course-page-body p, .course-page-body li {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .quiz-options .option.correct {
            background-color: #d1f7e0;
            border-color: var(--success);
            box-shadow: 0 0 0 3px var(--success);
        }
        .quiz-options .option.incorrect {
            background-color: #fcebeb;
            border-color: #f56565;
            box-shadow: 0 0 0 3px #f56565;
        }
        
        /* Login Gate Modal - Adjusted for relative positioning */
        .login-gate { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(255, 255, 255, 0.95); 
            z-index: 10; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            padding: 40px; 
            text-align: center;
            border-radius: 16px;
            min-height: 500px; /* Ensure space for content gate */
        }
         /* Video Section Styles (Needed here for thumbnail) */
        .video-wrapper {
            margin: 30px 0;
            position: relative;
            cursor: pointer;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
            aspect-ratio: 16/9;
        }
        .video-wrapper:hover { transform: scale(1.02); }
        .video-wrapper img { width: 100%; height: 100%; object-fit: cover; }
        .video-wrapper .play-button {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 4.5rem; color: rgba(255, 255, 255, 0.9); text-shadow: 0 2px 10px rgba(0,0,0,0.3); transition: transform 0.2s ease, color 0.2s ease; pointer-events: none;
        }
        .video-embed-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
        }
        .video-embed-container iframe {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 16px;
        }
        
        /* Instructor Card Styling */
        .instructor-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 30px;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            margin-bottom: 40px;
            background: #f7fafc;
        }
        .instructor-card img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary);
            margin-bottom: 15px;
        }
        .overview-details p {
            display: flex;
            align-items: center;
            font-size: 1.1rem;
        }
    </style>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-auth-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-firestore-compat.min.js"></script>
</head>
<body>
    <div id="loadingOverlay">
        <div class="spinner-large"></div>
        <p id="loadingText">Loading secure content...</p>
    </div>

    <header>
        <div class="container header-container">
            <a href="../../index.html" class="logo">
                <img src="../../images/logo.jpg" alt="InternAdda Logo" class="logo-img">
                <span class="logo-text">InternAdda</span>
            </a>

            <nav class="nav-menu">
                <a href="../../index.html" class="nav-link">Home</a>
                <a href="../course.html" class="nav-link">Courses</a>
                <a href="../../intern/internship.html" class="nav-link">Internships</a>
            </nav>
            
            <div class="header-actions">
                <div id="authButtons">
                    <a href="#" class="btn btn-outline" id="loginBtnHeader" onclick="window.showLoginModal()">Log in</a>
                    <a href="#" class="btn btn-primary" id="signupBtnHeader" onclick="window.showLoginModal()">Sign up</a>
                </div>

                <div class="user-profile hidden" id="userProfile">
                    <img src="../../images/no_image.png" alt="User Avatar" class="user-avatar-header" id="userAvatarHeader">
                    <span id="userNameHeader"></span>
                    <div class="dropdown-menu" id="userDropdown">
                        <button id="profileBtnHeader">My Profile</button>
                        <button id="logoutBtnHeader">Sign Out</button>
                    </div>
                </div>
            </div>
            </div>
    </header>
    <main>
        <section class="course-section">
            <div class="main-content-container" id="mainContentContainer">
                
                <div class="login-gate" id="contentGate">
                    <i class="fas fa-lock" style="font-size: 4rem; color: var(--primary); margin-bottom: 30px;"></i>
                    <h2>Login Required to View Course</h2>
                    <p>Please sign in to access the full course material and track your learning progress.</p>
                    <button class="btn btn-primary" onclick="window.showLoginModal()" id="enrollmentOrLoginBtn">Sign In Now</button>
                </div>
                
                <div id="courseContent" class="hidden">
                    
                    <h1 class="course-title-main fade-in">Essential Data Science Intern Course</h1>
                    
                    <div id="video-container" class="fade-in">
                        </div>

                    <div class="progress-container fade-in">
                        <div class="progress-bar-bg">
                            <div class="progress-bar-fill" id="progressBar"></div>
                        </div>
                        <span class="progress-text" id="progressText">0% Complete</span>
                    </div>

                    <div class="course-content-wrapper">
                        
                         <div class="course-page hidden" data-page="0">
                            <div class="fade-in">
                                <h2 class="course-page-title" style="text-align: center; font-size: 2.5rem; border-bottom: none;">Course Overview: Get Enrolled</h2>
                                
                                <div class="instructor-card">
                                    <img src="../../images/founder.jpg" alt="Instructor Lucky Kumar" style="border-color: var(--secondary);">
                                    <h3 style="font-size: 1.5rem; margin-bottom: 5px;">Lucky Kumar</h3>
                                    <p style="color: var(--primary); font-weight: 600; margin-bottom: 15px;">Your Instructor</p>
                                    <p style="font-size: 1rem; color: var(--gray);"><strong>DU Graduate</strong> with <strong>3+ years</strong> of teaching experience. Dedicated to bridging the gap between academia and industry.</p>
                                </div>
                                <h3 style="font-size: 1.8rem; margin-bottom: 15px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">Course Details</h3>
                                <div class="overview-details">
                                     <p style="margin-bottom: 10px;"><i class="fas fa-clock" style="color: var(--primary); margin-right: 10px;"></i> <strong>Estimated Time:</strong> 30 Minutes</p>
                                     <p style="margin-bottom: 10px;"><i class="fas fa-trophy" style="color: var(--primary); margin-right: 10px;"></i> <strong>Certification:</strong> Professional Certificate of Completion</p>
                                     <h4 style="font-size: 1.2rem; margin-top: 20px; margin-bottom: 10px;">Key Topics:</h4>
                                     <ul style="list-style-type: none; padding-left: 0; margin-bottom: 30px;">
                                         <li><i class="fas fa-code" style="color: var(--accent); margin-right: 8px;"></i> Python Fundamentals & Data Handling (Pandas/NumPy)</li>
                                         <li><i class="fas fa-chart-line" style="color: var(--accent); margin-right: 8px;"></i> SQL Basics & Data Visualization (Tableau Concepts)</li>
                                         <li><i class="fas fa-calculator" style="color: var(--accent); margin-right: 8px;"></i> Statistics, Hypothesis Testing, and ML/AI Concepts</li>
                                         <li><i class="fas fa-briefcase" style="color: var(--accent); margin-right: 8px;"></i> Professional Data Workflow & Career Tips</li>
                                     </ul>
                                </div>
                                
                                <button class="btn btn-primary btn-lg" style="width: 100%;" id="startEnrollmentButtonActual">Enroll for Free</button>
                            </div>
                        </div>
                        <div class="course-page hidden" data-page="1">
                            <div class="fade-in">
                                <h2 class="course-page-title">Page 1: Data Science Fundamentals & Workflow</h2>
                                <div class="course-page-body">
                                    <p><strong>üéØ Objective:</strong> Understand the definition of Data Science, its core required skills, and the professional workflow used in the industry.</p>
                                    
                                    <h3>1Ô∏è‚É£ The Foundation of Data Science</h3>
                                    <p>At its core, data science is the discipline of <strong>extracting valuable knowledge and actionable insights from data</strong>. It‚Äôs a powerful fusion of fields, where mastering the overlap creates true value.</p>
                                    
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>Skill</th>
                                                    <th>Role</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong>Statistics & Math</strong></td>
                                                    <td>To understand patterns in data and validate conclusions rigorously.</td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Programming (Python/SQL)</strong></td>
                                                    <td>The tool to automate data collection, analysis, and model building efficiently.</td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Domain Knowledge</strong></td>
                                                    <td>To ask the right business questions and accurately interpret the results.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    
                                    <h3>2Ô∏è‚É£ The Industry Workflow (CRISP-DM Essence)</h3>
                                    <p>Professional Data Science projects follow a systematic 6-step process:</p>
                                    <ol>
                                        <li><strong>Business Understanding:</strong> Clearly defining the problem and project goals.</li>
                                        <li><strong>Data Understanding:</strong> Collecting raw data and performing initial exploration.</li>
                                        <li><strong>Data Preparation:</strong> Handling missing values, cleaning data, and performing Feature Engineering.</li>
                                        <li><strong>Modeling:</strong> Building and training Machine Learning models.</li>
                                        <li><strong>Evaluation:</strong> Assessing the model's performance and impact.</li>
                                        <li><strong>Deployment:</strong> Sharing findings and implementing the solution for real-world use.</li>
                                    </ol>
                                </div>
                                <div class="quiz-section">
                                    <h3 class="quiz-question">‚ùì Question 1/5</h3>
                                    <p>A food delivery startup wants to forecast pizza demand by neighborhood. Which critical step should be done first?</p>
                                    <div class="quiz-options">
                                        <div class="option" data-answer="1">A. Immediately train a complex deep neural network model.</div>
                                        <div class="option" data-answer="2">B. Collect, clean, and thoroughly explore the historical order data.</div>
                                        <div class="option" data-answer="3">C. Double the marketing budget for a month to check the impact.</div>
                                        <div class="option" data-answer="4">D. Create a colorful dashboard for management, ignoring the data quality.</div>
                                    </div>
                                    <div class="quiz-feedback hidden" id="feedback1"></div>
                                    <button class="btn btn-primary hidden" id="nextButton1">Next Lesson <i class="fas fa-chevron-right"></i></button>
                                </div>
                            </div>
                        </div>

                        <div class="course-page hidden" data-page="2">
                           <div class="fade-in">
                                <h2 class="course-page-title">Page 2: Python and Data Handling Libraries</h2>
                                <div class="course-page-body">
                                    <p><strong>üéØ Objective:</strong> Gain mastery over essential Python libraries (Pandas, NumPy) used for manipulation and analysis in Data Science.</p>

                                    <h3>1Ô∏è‚É£ The Big 3 Data Tools</h3>
                                    <p>These core Python libraries are non-negotiable for professional data work:</p>

                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>Library</th>
                                                    <th>Purpose</th>
                                                    <th>Example</th>
                                                    <th>Primary Data Structure</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong>NumPy</strong></td>
                                                    <td>Fast numerical computations, especially for arrays and matrices.</td>
                                                    <td><code>np.mean(my_array)</code></td>
                                                    <td>NumPy Array</td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Pandas</strong></td>
                                                    <td>Data manipulation, cleaning, and analysis (the 'Excel' of Python).</td>
                                                    <td><code>df.groupby('category')['sales'].sum()</code></td>
                                                    <td>DataFrame</td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Matplotlib/Seaborn</strong></td>
                                                    <td>Creating informative and aesthetic data visualizations.</td>
                                                    <td><code>sns.scatterplot(x, y, data=df)</code></td>
                                                    <td>Plots/Charts</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <h3>2Ô∏è‚É£ Handling Missing Data</h3>
                                    <p>Missing values (`NaN`) are common in real-world data. Treating them incorrectly can heavily skew your results. Imputation (filling them in) is safer than dropping rows, especially if the dataset is small.</p>

                                    <h3>3Ô∏è‚É£ Professional Habits</h3>
                                    <ul>
                                        <li><strong>Virtual Environments:</strong> Always isolate project dependencies using <code>venv</code> to prevent conflicts.</li>
                                        <li><strong>Readable Code:</strong> Write clear, commented code‚Äîyour future self and teammates will thank you.</li>
                                    </ul>
                                </div>
                                <div class="quiz-section">
                                    <h3 class="quiz-question">‚ùì Question 2/5</h3>
                                    <p>You find several `NaN` (missing) values in a Pandas DataFrame column that represents product price. Which imputation method is generally the safest when the column may contain outliers?</p>
                                    <div class="quiz-options">
                                        <div class="option" data-answer="1">A. Remove all rows containing the `NaN` values.</div>
                                        <div class="option" data-answer="2">B. Replace missing prices with the column's mean (Average).</div>
                                        <div class="option" data-answer="3">C. Replace missing prices with the column's median (Middle Value).</div>
                                        <div class="option" data-answer="4">D. Replace missing prices with the numerical value 0.</div>
                                    </div>
                                    <div class="quiz-feedback hidden" id="feedback2"></div>
                                    <button class="btn btn-primary hidden" id="nextButton2">Next Lesson <i class="fas fa-chevron-right"></i></button>
                                </div>
                            </div>
                        </div>

                        <div class="course-page hidden" data-page="3">
                            <div class="fade-in">
                                <h2 class="course-page-title">Page 3: Statistics and Hypothesis Testing</h2>
                                <div class="course-page-body">
                                    <p><strong>üéØ Objective:</strong> Understand the statistical rigor needed to validate your data findings and make confident business recommendations.</p>

                                    <h3>1Ô∏è‚É£ Proving Your Claims</h3>
                                    <p>Statistics allows you to measure <strong>uncertainty</strong> and moves your conclusions from mere opinions to empirically <strong>validated insights</strong>. This is critical for driving trustworthy business decisions.</p>

                                    <h3>2Ô∏è‚É£ The Core of Hypothesis Testing</h3>
                                    <ol>
                                        <li><strong>Null Hypothesis (H‚ÇÄ):</strong> The default assumption of "no effect" or "no difference." (e.g., "The new website button has no impact on sales.")</li>
                                        <li><strong>Alternative Hypothesis (H‚ÇÅ):</strong> The claim you are trying to prove.</li>
                                    </ol>
                                    <p>You calculate a <strong>P-Value</strong>, which tells you the probability of observing your current data if the Null Hypothesis (H‚ÇÄ) were true. If the P-Value is very low (typically below 0.05), you <strong>reject H‚ÇÄ</strong> and conclude there is a real, significant effect.</p>
                                    
                                    <h3>3Ô∏è‚É£ Key Statistical Tools</h3>
                                    <ul>
                                        <li><strong>A/B Testing:</strong> Comparing two versions (A and B) to see which performs better based on a measurable goal.</li>
                                        <li><strong>T-Test:</strong> Used to compare the means (averages) of two different groups.</li>
                                        <li><strong>Chi-Squared Test:</strong> Used to test relationships between categorical variables.</li>
                                    </ul>
                                </div>
                                <div class="quiz-section">
                                    <h3 class="quiz-question">‚ùì Question 3/5</h3>
                                    <p>A company launched a new website layout (Version B) and saw a 10% increase in sign-ups compared to the old layout (Version A). What method should the data scientist use to confirm this improvement is not due to random chance?</p>
                                    <div class="quiz-options">
                                        <div class="option" data-answer="1">A. Reject the results because the increase is only 10%.</div>
                                        <div class="option" data-answer="2">B. Visualize the sign-up rates over time using a line chart.</div>
                                        <div class="option" data-answer="3">C. Perform a statistical A/B Test (e.g., T-Test) to calculate the P-Value and confidence level.</div>
                                        <div class="option" data-answer="4">D. Immediately delete the old website layout (Version A).</div>
                                    </div>
                                    <div class="quiz-feedback hidden" id="feedback3"></div>
                                    <button class="btn btn-primary hidden" id="nextButton3">Next Lesson <i class="fas fa-chevron-right"></i></button>
                                </div>
                            </div>
                        </div>

                        <div class="course-page hidden" data-page="4">
                            <div class="fade-in">
                                <h2 class="course-page-title">Page 4: Data Storytelling with Visualization and SQL</h2>
                                <div class="course-page-body">
                                    <p><strong>üéØ Objective:</strong> Learn essential SQL commands for data access and the visualization best practices for communicating complex insights effectively.</p>

                                    <h3>1Ô∏è‚É£ SQL Fundamentals for Data Access</h3>
                                    <p>SQL is the standard language for querying, updating, and managing relational databases. As a Data Scientist, mastering the following is crucial:</p>
                                    <ul>
                                        <li><strong>SELECT</strong> and <strong>FROM</strong>: Specifies the columns and tables to retrieve data from.</li>
                                        <li><strong>WHERE</strong>: Filters records based on a specified condition (e.g., sales > 1000).</li>
                                        <li><strong>GROUP BY</strong>: Aggregates rows with identical values into summary rows (e.g., total sales per city).</li>
                                        <li><strong>JOIN</strong>: Combines columns from two or more tables based on a related column between them.</li>
                                    </ul>

                                    <h3>2Ô∏è‚É£ Effective Visualization Choices</h3>
                                    <p>The right chart makes your findings instantly understandable. Choose wisely:</p>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>Chart Type</th>
                                                    <th>When to Use It</th>
                                                    <th>Best for</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong>Line Chart</strong></td>
                                                    <td>Tracking stock price, temperatures, or website traffic over time.</td>
                                                    <td>Showing Trends</td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Bar Chart</strong></td>
                                                    <td>Comparing the total count or value across distinct product categories or regions.</td>
                                                    <td>Comparing Categories</td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Scatter Plot</strong></td>
                                                    <td>Investigating the relationship (correlation) between two numerical variables.</td>
                                                    <td>Showing Relationships</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="quiz-section">
                                    <h3 class="quiz-question">‚ùì Question 4/5</h3>
                                    <p>Which SQL clause is used to filter records BEFORE any aggregation (GROUP BY) takes place?</p>
                                    <div class="quiz-options">
                                        <div class="option" data-answer="1">A. `SELECT`</div>
                                        <div class="option" data-answer="2">B. `WHERE`</div>
                                        <div class="option" data-answer="3">C. `HAVING`</div>
                                        <div class="option" data-answer="4">D. `FILTER`</div>
                                    </div>
                                    <div class="quiz-feedback hidden" id="feedback4"></div>
                                    <button class="btn btn-primary hidden" id="nextButton4">Next Lesson <i class="fas fa-chevron-right"></i></button>
                                </div>
                            </div>
                        </div>

                        <div class="course-page hidden" data-page="5">
                            <div class="fade-in">
                                <h2 class="course-page-title">Page 5: Machine Learning and Career Success</h2>
                                <div class="course-page-body">
                                    <p><strong>üéØ Objective:</strong> Understand core ML concepts like Overfitting and learn the soft skills necessary to thrive in a technical internship.</p>

                                    <h3>1Ô∏è‚É£ Supervised vs. Unsupervised Learning</h3>
                                    <ul>
                                        <li><strong>Supervised Learning:</strong> Predicts output based on labeled input data (e.g., Classification, Regression).</li>
                                        <li><strong>Unsupervised Learning:</strong> Finds patterns in unlabeled data without guidance (e.g., Clustering, finding anomalies).</li>
                                    </ul>

                                    <h3>2Ô∏è‚É£ The Pitfall of Overfitting</h3>
                                    <p><strong>Overfitting</strong> is the most critical ML failure: the model performs perfectly on the training data but fails miserably on new data because it learned the "noise," not the general pattern. The solution is often adding more data or using <strong>Regularization</strong> (like Dropout or L1/L2 penalties) to simplify the model.</p>

                                    <h3>3Ô∏è‚É£ Key Internship Habits</h3>
                                    <p>Your soft skills will determine your career trajectory:</p>
                                    <ul>
                                        <li><strong>Version Control (Git):</strong> This is mandatory. Learn how to commit, push, pull, and manage branches efficiently.</li>
                                        <li><strong>Clear Communication:</strong> Always summarize your complex work into simple, clear points for non-technical stakeholders.</li>
                                        <li><strong>Self-Sufficiency:</strong> Debug before you ask. Show that you have put in maximum effort before seeking help.</li>
                                    </ul>
                                        <div class="takeaways">
                                            <h3>Key Takeaways from This Course</h3>
                                            <ul>
                                                <li>Data Science is driven by Business Value, validated by Statistics.</li>
                                                <li>The core stack is Python, Pandas, SQL, and effective Visualization.</li>
                                                <li>Avoid Overfitting and prioritize Git for version control.</li>
                                                <li>Clear communication and documentation are essential for career growth.</li>
                                            </ul>
                                        </div>
                                </div>
                                <div class="quiz-section">
                                    <h3 class="quiz-question">‚ùì Final Question 5/5</h3>
                                    <p>Which concept best describes the necessity of using Git for any professional software or data project?</p>
                                    <div class="quiz-options">
                                        <div class="option" data-answer="1">A. It is only required for deployment to the production server.</div>
                                        <div class="option" data-answer="2">B. It automates testing and deployment pipelines.</div>
                                        <div class="option" data-answer="3">C. It tracks code history, enables team collaboration, and allows quick rollback to previous versions in case of errors.</div>
                                        <div class="option" data-value="4">D. It speeds up the data loading process for Pandas DataFrames.</div>
                                    </div>
                                    <div class="quiz-feedback hidden" id="feedback5"></div>
                                    <a href="javascript:void(0);" class="btn btn-primary hidden" id="finishButton">Get Certificate of Completion <i class="fas fa-award"></i></a>
                                </div>
                            </div>
                        </div>
                        
                        </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <div class="footer-logo">Internadda</div>
                    <p class="footer-description">Transforming careers through learning, interning, and earning opportunities.</p>
                    <div class="social-links">
                        <a href="https://www.linkedin.com/company/internadda-india" target="_blank" class="social-link" aria-label="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@theinternadda" target="_blank" class="social-link" aria-label="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/internadda.india" target="_blank" class="social-link" aria-label="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
                <div class="footer-links-column">
                    <h3 class="footer-links-title">Learn</h3>
                    <ul class="footer-links">
                        <li><a href="../course.html">Browse Courses</a></li>
                        <li><a href="#">Free Courses</a></li>
                        <li><a href="#">For Businesses</a></li>
                        <li><a href="#">Become an Instructor</a></li>
                        <li><a href="#">Affiliate Program</a></li>
                    </ul>
                </div>
                <div class="footer-links-column">
                    <h3 class="footer-links-title">Intern</h3>
                    <ul class="footer-links">
                        <li><a href="../../intern/internship.html">Find Internships</a></li>
                        <li><a href="#">For Companies</a></li>
                        <li><a href="#">Success Stories</a></li>
                        <li><a href="#">Career Coaching</a></li>
                        <li><a href="#">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-links-column">
                    <h3 class="footer-links-title">Contact & Legal</h3>
                    <ul class="footer-links">
                        <li><a href="../../about.html">About Us</a></li>
                        <li><a href="../../contact.html">Contact Us</a></li>
                        <li><a href="../../terms.html">Terms & Conditions</a></li>
                        <li><a href="../../privacy.html">Privacy Policy</a></li>
                        <li><a href="../../refund.html">Refund Policy</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2025 Internadda. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <script src="../../script.js"></script>
    
    <script>
        // Course Specific Details
        const COURSE_TITLE = "Essential Data Science Intern Course";
        const TOTAL_LESSON_PAGES = 5; // Pages 1 to 5 are content pages
        const TOTAL_PAGES = 1 + TOTAL_LESSON_PAGES; // Page 0 (Overview) + 5 Lesson Pages
        const LOGIN_REDIRECT_ELEMENT_ID = 'loginBtnHeader'; // Element to click to open the modal

        // FIX: Re-mapped correct answers and ensured 4 options (MCQ fix)
        const quizData = {
            1: { correct: 2, options: 4, feedback: "‚úÖ Correct! Starting with historical data (Step 2) is essential to define the problem and understand underlying trends before building any model (Step 4)." },
            2: { correct: 3, options: 4, feedback: "‚úÖ Correct! Median is preferred over Mean for imputation when outliers are present, as the Median is robust against extreme values." },
            3: { correct: 3, options: 4, feedback: "‚úÖ Correct! An A/B test with a T-Test is the statistical framework used to determine if the observed difference is statistically significant (i.e., not random chance)." },
            4: { correct: 2, options: 4, feedback: "‚úÖ Correct! The `WHERE` clause filters rows before aggregation (GROUP BY), while `HAVING` filters results AFTER aggregation." },
            5: { correct: 3, options: 4, feedback: "‚úÖ Correct! Version control tracks history, enables collaboration (merging), and protects against catastrophic errors by allowing quick rollback." }
        };
        
        // Video IDs for each page (simulating dynamic content)
        const pageVideoIds = {
            1: "x-G-dSSUNQE", // Example: Introduction to Data Science
            2: "JOlruyTytz8", // Example: Python & Essential Libraries
            3: "Cc-RKfvITzo", // Example: Statistics & Probability Essentials
            4: "4tYY6NFRfws", // Example: Data Wrangling & Visualization
            5: "i_LwzRVP7bg" // Example: Machine Learning & The Intern Mindset
        };
        
        // --- Core Logic Elements ---
        const coursePages = document.querySelectorAll('.course-page');
        const progressFill = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const finishButton = document.getElementById('finishButton');
        const videoContainer = document.getElementById('video-container');
        const contentGate = document.getElementById('contentGate');
        const courseContent = document.getElementById('courseContent');
        const mainContentContainer = document.getElementById('mainContentContainer');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const enrollmentOrLoginBtn = document.getElementById('enrollmentOrLoginBtn');
        const startEnrollmentButtonActual = document.getElementById('startEnrollmentButtonActual'); // Button on Page 0

        let currentPage = 0; // Start at overview page (Page 0)
        let isUserEnrolled = false;
        
        // Helper to get Firestore path (Assumes global auth and db from script.js)
        function getUserPath(collection) {
            const user = firebase.auth().currentUser;
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            return `artifacts/${appId}/users/${user.uid}/${collection}`;
        }
        
        // Helper to load and save progress (replaces old logic from script.js global functions for this page)
        const saveProgressLocal = async (pageNumber, isCompleted) => {
            const user = firebase.auth().currentUser;
            // The logic below ensures that if the user is anonymous (not truly logged in), 
            // we don't try to save non-anonymous data, preventing errors in a Canvas environment.
            if (!user || user.isAnonymous) return; 
            
            // Calculate progress based on lesson pages (1-5)
            const progressPage = Math.max(0, pageNumber - 1);
            const progressForDb = Math.min(100, Math.floor((progressPage / TOTAL_LESSON_PAGES) * 100));
            
            // NOTE: db is globally defined in script.js as firebase.firestore()
            const enrollmentsRef = db.collection(getUserPath('enrollments'));
            const docTitle = COURSE_TITLE;
            
            try {
                const existingEnrollment = await enrollmentsRef.where('title', '==', docTitle).limit(1).get();
                if (!existingEnrollment.empty) {
                    const docId = existingEnrollment.docs[0].id;
                    await enrollmentsRef.doc(docId).update({
                        progress: progressForDb,
                        lastPage: pageNumber,
                        completed: isCompleted,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                } else {
                    // Initial enrollment 
                     await enrollmentsRef.add({
                        title: docTitle,
                        progress: progressForDb, 
                        completed: isCompleted,
                        lastPage: pageNumber,
                        userId: user.uid
                    });
                }
                isUserEnrolled = true;
            } catch(e) {
                console.error("Error saving progress:", e);
            }
        };

        const loadProgressLocal = async (user) => {
             if (!user || user.isAnonymous) return null;
             try {
                const enrollmentsRef = db.collection(getUserPath('enrollments'));
                const existingEnrollment = await enrollmentsRef.where('title', '==', COURSE_TITLE).limit(1).get();
                 
                if (!existingEnrollment.empty) {
                    const data = existingEnrollment.docs[0].data();
                    isUserEnrolled = true;
                    return data;
                }
                isUserEnrolled = false;
                return null;
             } catch(e) {
                 console.error("Error loading progress:", e);
                 isUserEnrolled = false;
                 return null;
             }
        }
        
        // Helper to update progress visualization
        const updateProgressUI = (pageNumber) => {
            // Only pages 1-5 count towards progress
            const progressPage = Math.max(0, pageNumber - 1);
            const progressPercentage = Math.min(100, Math.floor((progressPage / TOTAL_LESSON_PAGES) * 100));
            
            if (progressFill && progressText) {
                progressFill.style.width = `${progressPercentage}%`;
                progressText.textContent = `${progressPercentage}% Complete`;
            }
        };

        const loadVideoForPage = (pageNumber) => {
             // Only load video for actual lesson pages (1-5)
            if (pageNumber < 1) {
                if (videoContainer) videoContainer.innerHTML = ''; // Clear video container for Page 0
                return;
            }
            // FIX: Use the correct video ID for the page
            const videoId = pageVideoIds[pageNumber];
            
            if (videoContainer) {
                 // Reset video container to thumbnail view
                videoContainer.innerHTML = `
                    <div class="video-wrapper" id="video-thumbnail-new">
                        <img src="https://img.youtube.com/vi/${videoId}/maxresdefault.jpg" alt="Course Video Thumbnail" onerror="this.onerror=null; this.src='https://placehold.co/600x338/546e7a/ffffff?text=Video+Not+Available'">
                        <div class="play-button"><i class="fas fa-play-circle"></i></div>
                    </div>
                `;
                const currentVideoThumbnail = videoContainer.querySelector('#video-thumbnail-new');
                if (currentVideoThumbnail) {
                    currentVideoThumbnail.addEventListener('click', () => {
                        const iframeContainer = document.createElement('div');
                        iframeContainer.classList.add('video-embed-container');
                        const iframe = document.createElement('iframe');
                        // FIX: Use the video ID for embedding
                        iframe.setAttribute('src', `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`);
                        iframe.setAttribute('title', 'YouTube video player');
                        iframe.setAttribute('frameborder', '0');
                        iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share');
                        iframe.setAttribute('allowfullscreen', '');
                        iframeContainer.appendChild(iframe);
                        videoContainer.innerHTML = ''; 
                        videoContainer.appendChild(iframeContainer);
                    });
                }
            }
        };

        const showPage = (pageNumber) => {
            coursePages.forEach(page => page.classList.add('hidden'));
            let newPage = document.querySelector(`[data-page="${pageNumber}"]`);
            
            if (!newPage) {
                pageNumber = 1; // Fallback to page 1
                newPage = document.querySelector(`[data-page="${pageNumber}"]`);
                if (newPage) currentPage = 1;
            }
            
            if (newPage) {
                newPage.classList.remove('hidden');
                const newContent = newPage.querySelector('.fade-in');
                if(newContent) {
                     newContent.classList.remove('visible');
                     // Use setTimeout to ensure re-observing works
                     setTimeout(() => {
                         const tempObserver = new IntersectionObserver((entries) => {
                             entries.forEach(entry => {
                                 if (entry.isIntersecting) {
                                     entry.target.classList.add('visible');
                                     tempObserver.unobserve(entry.target); // Stop observing once visible
                                 }
                             });
                         }, { threshold: 0.1 });
                         tempObserver.observe(newContent);
                     }, 10);
                }
                
                updateProgressUI(pageNumber); 
                loadVideoForPage(pageNumber);
                
                // Save the current page to track progress (only save progress for pages >= 1)
                if(pageNumber >= 1) {
                    saveProgressLocal(pageNumber, pageNumber > TOTAL_LESSON_PAGES);
                }

                // Smooth scroll to the content wrapper
                document.querySelector('main').scrollIntoView({ behavior: 'smooth' });
            }
        };
        
        const updateUI = () => {
            // Setup navigation buttons functionality for pages 1-5
            for (let i = 1; i <= TOTAL_LESSON_PAGES; i++) {
                const page = document.querySelector(`[data-page="${i}"]`);
                const nextButton = page.querySelector(`#nextButton${i}`);
                if (nextButton) {
                    nextButton.addEventListener('click', () => {
                        currentPage = Math.min(TOTAL_LESSON_PAGES + 1, currentPage + 1);
                        showPage(currentPage);
                    });
                }
            }
        };
        
        const handleQuiz = (pageNumber) => {
            const page = document.querySelector(`[data-page="${pageNumber}"]`);
            const options = page.querySelectorAll('.option');
            const feedbackDiv = page.querySelector('.quiz-feedback');
            const nextButton = page.querySelector(`#nextButton${pageNumber}`);
            
            options.forEach(option => {
                option.addEventListener('click', () => {
                    // Check if question is already answered (options disabled)
                    if (options[0].style.pointerEvents === 'none') return;

                    const selected = parseInt(option.dataset.answer);
                    const correctOption = quizData[pageNumber].correct;

                    options.forEach(opt => opt.style.pointerEvents = 'none');
                    option.classList.remove('incorrect');
                    option.classList.remove('correct');
                    
                    // Display correct answer visually
                    options.forEach(opt => {
                        if(parseInt(opt.dataset.answer) === correctOption) {
                             opt.classList.add('correct');
                        }
                    });

                    if (selected === correctOption) {
                        feedbackDiv.textContent = quizData[pageNumber].feedback;
                        feedbackDiv.style.color = 'var(--success)';
                        
                        if (nextButton) {
                            nextButton.classList.remove('hidden');
                        } else if (finishButton) {
                            // Last page completed
                            finishButton.classList.remove('hidden');
                            saveProgressLocal(TOTAL_LESSON_PAGES + 1, true); // Mark 100% completion in Firestore
                        }
                    } else {
                        option.classList.add('incorrect');
                        feedbackDiv.textContent = "‚ùå Incorrect. Please review the content on this page and try again in 2 seconds.";
                        feedbackDiv.style.color = 'var(--warning)';
                        
                        if (nextButton) nextButton.classList.add('hidden');

                        setTimeout(() => {
                            options.forEach(opt => {
                                opt.classList.remove('incorrect');
                                opt.classList.remove('correct');
                                opt.style.pointerEvents = 'auto'; // Re-enable for retry
                            });
                            feedbackDiv.classList.add('hidden');
                        }, 2000);
                    }
                    feedbackDiv.classList.remove('hidden');
                });
            });
        };
        
        // Function to handle enrollment and transition to the first lesson
        const enrollAndStart = async (e) => {
            e.preventDefault();
            const user = firebase.auth().currentUser;
            if (user && !user.isAnonymous) {
                // Perform enrollment in Firestore
                await saveProgressLocal(1, false);
                currentPage = 1;
                showPage(currentPage);
            } else {
                 // Trigger login modal if not logged in
                 window.showLoginModal();
            }
        };

        // --- FIREBASE AUTH GATE & ENROLLMENT FIX ---
        
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize quiz handlers for pages 1-5
            for (let i = 1; i <= TOTAL_LESSON_PAGES; i++) {
                handleQuiz(i);
            }

            if (finishButton) {
                finishButton.addEventListener('click', () => {
                     // Ensure user is still logged in before generating/redirecting
                     const user = firebase.auth().currentUser;
                     if (!user || user.isAnonymous) {
                         alert("Please log in to generate your personalized certificate."); 
                         window.showLoginModal();
                         return;
                     }
                    
                    // Use the logged-in user's name
                    const userName = user.displayName || user.email.split('@')[0]; 
                    const courseNameEncoded = encodeURIComponent(COURSE_TITLE);
                    const nameEncoded = encodeURIComponent(userName);
                    
                    // 1. Redirect to certificate page (which auto-generates the PDF)
                    window.location.href = `certificate.html?name=${nameEncoded}&course=${courseNameEncoded}`;

                    // 2. Alert the user about next steps (directing them to their profile)
                    // We cannot reliably call the dashboard directly from this file, 
                    // so we use a safe way to show the modal and rely on the profile tab logic.
                    setTimeout(() => {
                         alert("‚úÖ Certificate Generated and Downloaded! You can always re-download this certificate from the 'Courses' tab in your Profile Dashboard.");
                         window.showLoginModal(); 
                    }, 1500); 
                    
                });
            }
            
            // FIX: Show loading overlay immediately
            loadingOverlay.style.opacity = 1;
            
            // NOTE: auth.onAuthStateChanged is defined in script.js and will handle loading profile data and UI updates.
            // We only need to ensure the logic within this page handles its internal state correctly based on Firebase signal.
            
            // We override the default login button handler to always call window.showLoginModal()
            document.querySelectorAll('#authButtons a').forEach(btn => {
                 btn.onclick = (e) => { e.preventDefault(); window.showLoginModal(); };
            });
            
            // Setup internal state based on initial auth check (since this page runs before script.js's main listener finishes)
            firebase.auth().onAuthStateChanged(async user => {
                // Hide loading overlay once state is determined
                loadingOverlay.style.opacity = 0;
                setTimeout(() => { loadingOverlay.style.display = 'none'; }, 500);

                if (user && !user.isAnonymous) {
                    contentGate.classList.add('hidden');
                    courseContent.classList.remove('hidden');
                    
                    const savedProgress = await loadProgressLocal(user);
                    
                    if (savedProgress) {
                        isUserEnrolled = true;
                        currentPage = savedProgress.lastPage > 0 ? savedProgress.lastPage : 1;
                        if(currentPage === 0) currentPage = 1;
                        
                        if(startEnrollmentButtonActual) startEnrollmentButtonActual.textContent = "Continue Course";
                        if(startEnrollmentButtonActual) startEnrollmentButtonActual.removeEventListener('click', enrollAndStart);
                        if(startEnrollmentButtonActual) startEnrollmentButtonActual.addEventListener('click', () => { currentPage = 1; showPage(currentPage); });
                        
                    } else {
                        isUserEnrolled = false;
                        currentPage = 0;
                        if(startEnrollmentButtonActual) startEnrollmentButtonActual.textContent = "Enroll for Free";
                        if(startEnrollmentButtonActual) startEnrollmentButtonActual.removeEventListener('click', enrollAndStart);
                        if(startEnrollmentButtonActual) startEnrollmentButtonActual.addEventListener('click', enrollAndStart);
                    }
                    
                    updateUI();
                    showPage(currentPage);
                    
                    mainContentContainer.classList.add('content-loaded');
                    if (isUserEnrolled && savedProgress && savedProgress.completed && finishButton) {
                        finishButton.classList.remove('hidden');
                    }


                } else {
                    // User is logged out/anonymous: Show gate and overview page
                    contentGate.classList.remove('hidden');
                    courseContent.classList.add('hidden');
                    
                    currentPage = 0; 
                    updateProgressUI(0); 
                    
                    mainContentContainer.classList.add('content-loaded');
                }
            });
            
            showPage(0);
        });
        
    </script>
</body>
</html>
```</RFILE_EDIT>

---

## 2. script.js (Global Profile and Real-Time Tracking Logic)

‡§á‡§∏ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç, ‡§Æ‡•à‡§Ç‡§®‡•á `renderCourseProgress` ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ **‡§®‡§æ‡§Æ‡§æ‡§Ç‡§ï‡§ø‡§§ (enrolled) ‡§ï‡•ã‡§∞‡•ç‡§∏‡•á‡§ú** ‡§ï‡•ã ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡•á (‡§ú‡•ã Firestore ‡§∏‡•á ‡§Ü‡§§‡•á ‡§π‡•à‡§Ç), ‡§î‡§∞ ‡§∏‡§∞‡•ç‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§ü ‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡§∞ ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡•á‡•§

<RFILE_EDIT name="hozaak/internadda/internAdda-19e9cc6a6e6d7ec86790dd7a32b0e98a938a8a8e/script.js" >
### Modified: hozaak/internadda/internAdda-19e9cc6a6e6d7ec86790dd7a32b0e98a938a8a8e/script.js

```javascript
// ---------------------------------------------
// Firebase Auth & Firestore Logic (Compatibility SDK)
// ---------------------------------------------

// Global variables injected by the environment (Canvas system requirement)
const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
    apiKey: "AIzaSyCEas4FDRozXwhnzKeCz09LQnyCjY1twh4",
    authDomain: "internadda-c7217.firebaseapp.com",
    projectId: "internadda-c7217",
    // Placeholder config - replace with actual production values if possible
};
const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

// Initialize Firebase App and Services
if (typeof firebase !== 'undefined' && !firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
    // Set Firestore log level to debug for development visibility
    firebase.firestore.setLogLevel('debug'); 
}

const auth = firebase.auth();
const db = firebase.firestore();
const googleProvider = new firebase.auth.GoogleAuthProvider();

// Utility to ensure authenticated state before getting user data
async function getAuthenticatedUser() {
    if (initialAuthToken) {
        try {
            // Sign in using custom token provided by the environment
            await auth.signInWithCustomToken(initialAuthToken);
        } catch (error) {
            console.error("Custom token sign-in failed. Falling back to anonymous.", error);
            await auth.signInAnonymously();
        }
    } else if (!auth.currentUser) {
        // Fallback to anonymous sign-in if no custom token and no current user
        await auth.signInAnonymously();
    }
    return auth.currentUser;
}

// --- Firestore Data Paths ---
// Mandate: /artifacts/{appId}/users/{userId}/{collectionName}
function getUserPath(collection) {
    const user = auth.currentUser;
    const userId = user ? user.uid : 'anon-user';
    return `artifacts/${appId}/users/${userId}/${collection}`;
}

// --- MOCK INITIALIZATION DATA (Replaces old mock data arrays) ---
// This ensures that when a new user logs in, they see some placeholder data initially
const INITIAL_MOCK_COURSES = [
    { title: 'Essential Data Science Intern Course', progress: 0, completed: false, url: "/courses/courses/Essential Data Science Intern Course.html" },
    { title: 'Generative AI & Prompt Engineering', progress: 0, completed: false, url: "/courses/courses/Generative-AI-Prompt-Engineering-Masterclass.html" },
    { title: 'Ethical Hacking Mastery', progress: 0, completed: false, url: "/courses/courses/Ethical-Hacking-Mastery.html" }
];
const INITIAL_MOCK_INTERNSHIPS = [
    { title: 'Data Science & Analytics', status: 'Pending', score: 0, finalExamUrl: '/intern/payment_page_data_science.html' },
    { title: 'Artificial Intelligence & Machine Learning', status: 'Pending', score: 0, finalExamUrl: '/intern/payment_page_ai_ml.html' }
];

async function initializeUserData(user) {
    // Only run initialization if user is NOT anonymous
    if (user.isAnonymous) return;
    
    const profileRef = db.collection('users').doc(user.uid);
    const profileDoc = await profileRef.get();

    if (!profileDoc.exists) {
        // Initialize user profile
        await profileRef.set({
            email: user.email,
            name: user.displayName || user.email.split('@')[0],
            photoUrl: user.photoURL || '/images/no_image.png',
            gender: '',
            interestedDomain: '',
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
    }

    // Initialize mock courses if none exist
    const coursesPath = getUserPath('enrollments');
    const coursesSnapshot = await db.collection(coursesPath).limit(1).get();
    if (coursesSnapshot.empty) {
        const batch = db.batch();
        INITIAL_MOCK_COURSES.forEach(course => {
            const docRef = db.collection(coursesPath).doc();
            batch.set(docRef, { ...course, userId: user.uid });
        });
        INITIAL_MOCK_INTERNSHIPS.forEach(internship => {
            const docRef = db.collection(getUserPath('internships')).doc();
            batch.set(docRef, { ...internship, userId: user.uid });
        });
        await batch.commit();
    }
}

// --- UI Rendering Functions (Now uses Firestore real-time data) ---

// Hardcoded data (used only for search/listings and lookup for progress rendering)
const allCourses = [
    { title: 'Essential Data Science Intern Course', instructor: 'Lucky Kumar', image: '/images/Essential Data Science Intern Course.png', url: "/courses/courses/Essential Data Science Intern Course.html" },
    { title: 'Generative AI & Prompt Engineering', instructor: 'Lucky Kumar', image: '/images/Generative-AI-Prompt-Engineering-Masterclass.png', url: "/courses/courses/Generative-AI-Prompt-Engineering-Masterclass.html" },
    { title: 'Ethical Hacking Mastery', instructor: 'Lucky Kumar', image: '/images/Ethical-Hacking-Mastery.png', url: "/courses/courses/Ethical-Hacking-Mastery.html" },
    { title: 'Python Essentials for All', instructor: 'Lucky Kumar', image: '/images/Python-Essentials-for-All.png', url: "/courses/courses/Python-Essentials-for-All.html" },
    { title: 'Cloud & DevOps Essentials', instructor: 'Lucky Kumar', image: '/images/Cloud-DevOps-Essentials.png', url: "/courses/courses/Cloud-DevOps-Essentials.html" }
];

// FIX: This function now correctly shows only courses fetched from Firestore (enrolled courses)
function renderCourseProgress(coursesData) {
    const coursesListContainer = document.getElementById('coursesListContainer');
    if (!coursesListContainer) return;

    coursesListContainer.innerHTML = '';
    
    // Check if user is logged in
    const user = auth.currentUser;
    if (!user || user.isAnonymous) {
         coursesListContainer.innerHTML = '<p class="text-center empty-state" style="padding: 20px 0;">Please log in to view your courses.</p>';
         return;
    }
    
    if (coursesData.length === 0) {
        coursesListContainer.innerHTML = '<p class="text-center empty-state" style="padding: 20px 0;">You are not currently enrolled in any courses. <a href="/courses/course.html" class="text-primary font-semibold">Start learning now!</a></p>';
        return;
    }

    coursesData.forEach(course => {
        let buttonHtml;
        let statusColor;
        
        // Find the correct URL for the course using a title match fallback if 'url' field is missing from Firestore data
        // This is necessary because the course document in Firestore might be incomplete.
        const courseDetails = allCourses.find(c => course.title.includes(c.title)) || { url: '/courses/course.html' };
        // Use the URL saved in Firestore during enrollment or fallback to hardcoded
        const courseUrl = course.url || courseDetails.url; 

        if (course.completed && course.progress >= 99) {
            statusColor = 'var(--success)';
            // Ensure displayName is used, fallback to email local part
            const nameEncoded = encodeURIComponent(user.displayName || user.email.split('@')[0]);
            const courseNameEncoded = encodeURIComponent(course.title);
            const certificateUrl = `/courses/courses/certificate.html?name=${nameEncoded}&course=${courseNameEncoded}`;
            
            // POINT 5: Download Certificate Link in My Profile (Re-download capability)
            buttonHtml = `<a href="${certificateUrl}" target="_blank" class="btn btn-primary animate-pulse" style="padding: 8px 15px; font-size: 14px; background-color: var(--success);">Download Certificate</a>`;
        } else {
            statusColor = course.progress > 0 ? 'var(--warning)' : 'var(--primary)';
            buttonHtml = `<a href="${courseUrl}" class="btn btn-primary" style="padding: 8px 15px; font-size: 14px;">${course.progress > 0 ? 'Continue Course' : 'Start Course'}</a>`;
        }
        
        const itemHtml = `
            <div class="data-item animated-item">
                <div style="flex-grow: 1;">
                    <h4 style="font-size: 16px; margin-bottom: 8px; color: var(--dark);">${escapeHTML(course.title)}</h4>
                    <div style="font-size: 14px; color: var(--gray); display: flex; align-items: center; gap: 10px;">
                        <span style="font-weight: 600; color: ${statusColor};">${course.progress}% Complete</span>
                        <div style="flex-grow: 1; height: 8px; background-color: #e2e8f0; border-radius: 999px; max-width: 150px; overflow: hidden;">
                             <div style="height: 100%; width: ${course.progress}%; background-color: ${statusColor}; border-radius: 999px; transition: width 0.8s ease-out;"></div>
                        </div>
                    </div>
                </div>
                ${buttonHtml}
            </div>
        `;
        coursesListContainer.innerHTML += itemHtml;
    });
}

function renderInternshipHistory(internshipsData) {
    const internshipsListContainer = document.getElementById('internshipsListContainer');
    if (!internshipsListContainer) return;
    
    internshipsListContainer.innerHTML = '';
    
    const user = auth.currentUser;
    if (!user || user.isAnonymous) {
        internshipsListContainer.innerHTML = '<p class="text-center empty-state" style="padding: 20px 0;">Please log in to view your internship history.</p>';
        return;
    }

    if (internshipsData.length === 0) {
        internshipsListContainer.innerHTML = '<p class="text-center empty-state" style="padding: 20px 0;">No internship application or test history found. <a href="/intern/internship.html" class="text-primary font-semibold">Start your application!</a></p>';
        return;
    }

    internshipsData.forEach(internship => {
        let statusColor;
        let actionLink;
        let statusText;
        
        switch (internship.status) {
            case 'Passed':
                statusColor = 'var(--success)';
                statusText = `Qualified (${internship.score}%)`;
                // Assumes the finalExamUrl links to a final exam page that can display results on reload.
                actionLink = `<a href="${internship.finalExamUrl.replace('payment_page', 'ai_ml_final_exam')}" class="btn btn-primary" style="padding: 8px 15px; font-size: 14px; background-color: var(--success);">View Results</a>`;
                break;
            case 'Failed':
                statusColor = '#c53030'; // Red
                statusText = `Not Qualified (${internship.score}%)`;
                actionLink = `<a href="${internship.finalExamUrl}" class="btn btn-outline" style="padding: 8px 15px; font-size: 14px; border-color: #c53030; color: #c53030;">Re-attempt Exam</a>`;
                break;
            default: // Pending
                statusColor = 'var(--warning)';
                statusText = 'Awaiting Payment/Exam';
                actionLink = `<a href="${internship.finalExamUrl}" class="btn btn-primary" style="padding: 8px 15px; font-size: 14px;">Take Exam</a>`;
                break;
        }

        const itemHtml = `
            <div class="data-item animated-item">
                <div style="flex-grow: 1;">
                    <h4 style="font-size: 16px; margin-bottom: 8px; color: var(--dark);">${escapeHTML(internship.title)} Internship</h4>
                    <div style="font-size: 14px; color: var(--gray); display: flex; align-items: center; gap: 15px;">
                        <span style="font-weight: 600; color: ${statusColor};">Status: ${statusText}</span>
                    </div>
                </div>
                ${actionLink}
            </div>
        `;
        internshipsListContainer.innerHTML += itemHtml;
    });
}

// --- Profile Update/Save Logic (Uses Firestore) ---

async function saveProfileData(user) {
    const name = profileName.value.trim();
    const gender = profileGender.value;
    const domain = interestedDomain.value;
    let photoUrl = user.photoURL || '/images/no_image.png';

    // Image upload logic is complex and relies on Firebase Storage, so we will skip actual file upload.
    // If a new local image is selected, we update the preview but rely on the existing photoURL for persistence for now.

    const profileUpdate = {
        name: name,
        gender: gender,
        interestedDomain: domain,
        photoUrl: photoUrl, // Keep existing or default URL
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
    };

    try {
        await db.collection('users').doc(user.uid).set(profileUpdate, { merge: true });
        // Update user's display name in Firebase Auth too
        await user.updateProfile({ displayName: name }); 
        
        // Refresh UI
        loadProfileData(user);
        profileDisplaySection.classList.remove('hidden'); 
        profileEditSection.classList.add('hidden');
    } catch (error) {
        console.error("Profile save error:", error);
        // Assuming there is a generic error element in the edit section
        const errorElement = document.getElementById('profileEditSection').querySelector('.error');
        if (errorElement) showError(errorElement, "Failed to save profile. Please check connection.");
    }
}

async function loadProfileData(user) {
    const profileRef = db.collection('users').doc(user.uid);
    const doc = await profileRef.get();
    
    let profileData = {};

    if (doc.exists) {
        profileData = doc.data();
    } else {
         // Fallback to minimal data if doc doesn't exist
        profileData = {
            name: user.displayName || user.email.split('@')[0],
            email: user.email,
            photoUrl: user.photoURL || '/images/no_image.png',
            gender: 'Not specified',
            interestedDomain: 'Not specified'
        };
    }
    profileData.email = user.email; // Ensure email is current
    
    // Update both header and dashboard UI
    updateProfileUI(profileData);
}

// --- Auth State Observer (Handles profile updates and showing/hiding auth elements) ---
let courseUnsubscribe;
let internshipUnsubscribe;

auth.onAuthStateChanged(async (user) => {
    // 1. Manage UI for auth status (Desktop & Mobile)
    const authButtons = document.getElementById('authButtons');
    const userProfile = document.getElementById('userProfile');
    const authButtonsMobile = document.getElementById('authButtonsMobile');
    const userProfileMobile = document.getElementById('userProfileMobile');
    const dashboardSection = document.getElementById('dashboardSection');
    const loginSection = document.getElementById('loginSection');
    
    if (user && !user.isAnonymous) {
        // --- User is signed in ---
        if(authButtons) authButtons.classList.add('hidden');
        if(userProfile) userProfile.classList.remove('hidden');
        if(authButtonsMobile) authButtonsMobile.style.display = 'none'; // POINT 1
        if(userProfileMobile) userProfileMobile.classList.remove('hidden'); // POINT 1

        // Check/Initialize user's data on first login
        await initializeUserData(user);
        await loadProfileData(user);

        // 2. Setup real-time listeners for dashboard data
        if (courseUnsubscribe) courseUnsubscribe(); // Clear old listener
        if (internshipUnsubscribe) internshipUnsubscribe(); // Clear old listener

        courseUnsubscribe = db.collection(getUserPath('enrollments'))
            .onSnapshot(snapshot => {
                const courses = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderCourseProgress(courses);
            }, err => console.error("Firestore Courses Error:", err));

        internshipUnsubscribe = db.collection(getUserPath('internships'))
            .onSnapshot(snapshot => {
                const internships = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderInternshipHistory(internships);
            }, err => console.error("Firestore Internships Error:", err));

        // Redirect to dashboard if modal is active, or close modal if showing login/signup
        if (authModal && authModal.classList.contains('active')) {
             if(dashboardSection) showSection(dashboardSection);
        }

    } else {
        // --- User is signed out or anonymous ---
        if(authButtons) authButtons.classList.remove('hidden');
        if(userProfile) userProfile.classList.add('hidden');
        if(authButtonsMobile) authButtonsMobile.style.display = 'flex'; // POINT 1
        if(userProfileMobile) userProfileMobile.classList.add('hidden'); // POINT 1

        // 3. Clear listeners when logged out
        if (courseUnsubscribe) { courseUnsubscribe(); courseUnsubscribe = null; }
        if (internshipUnsubscribe) { internshipUnsubscribe(); internshipUnsubscribe = null; }

        // If modal is open, show login screen
        if (authModal && authModal.classList.contains('active')) {
            if(loginSection) showSection(loginSection);
        }
        
        // Hide/Reset profile content
        const coursesListContainer = document.getElementById('coursesListContainer');
        const internshipsListContainer = document.getElementById('internshipsListContainer');
        if(coursesListContainer) coursesListContainer.innerHTML = '<p class="text-center empty-state" style="padding: 20px 0;">Please log in to view your courses.</p>';
        if(internshipsListContainer) internshipsListContainer.innerHTML = '<p class="text-center empty-state" style="padding: 20px 0;">Please log in to view your internship history.</p>';
    }

    // 4. Handle full page access gate (Point 3)
    const isProtectedPage = window.location.pathname.includes('/courses/course.html') || window.location.pathname.includes('/intern/internship.html');
    const fullPageGate = document.getElementById('fullPageGate');
    const mainContentArea = document.querySelector('.courses-grid') || document.querySelector('.courses-list') || document.querySelector('.courses');

    if (isProtectedPage) {
        if (user && !user.isAnonymous) {
            if (fullPageGate) fullPageGate.classList.add('hidden');
            if (mainContentArea) mainContentArea.style.display = 'grid'; 
        } else {
            if (!fullPageGate) {
                // If gate hasn't been created by the other page's script, create it here (Fallback)
                const container = document.querySelector('main .courses .container') || document.querySelector('main .value-prop .container');
                if (container) {
                    const gate = document.createElement('div');
                    gate.id = 'fullPageGate';
                    gate.innerHTML = `
                         <div class="login-gate" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--light); z-index: 10; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px; text-align: center; border-radius: 14px;">
                           <i class="fas fa-lock" style="font-size: 4rem; color: var(--primary); margin-bottom: 30px;"></i>
                            <h2 style="font-size: 2.2rem; color: var(--dark); margin-bottom: 20px;">Login Required to View This Content</h2>
                           <p style="font-size: 1.2rem; color: var(--gray); max-width: 600px; margin-bottom: 30px;">Please sign in or create an account to view courses and apply for internships.</p>
                           <button class="btn btn-primary" id="fullPageLoginButton" onclick="document.getElementById('loginBtnHeader').click()">Sign In Now</button>
                          </div>
                      `;
                    container.style.position = 'relative';
                    container.appendChild(gate);
                }
            } else {
                fullPageGate.classList.remove('hidden');
            }
            if (mainContentArea) mainContentArea.style.display = 'none';
        }
    }
});


// --- DOM Elements (Repeated for local use) ---
const authModal = document.getElementById('authModal');
const closeModalBtn = document.getElementById('closeModal');
const loginSection = document.getElementById('loginSection');
const signupSection = document.getElementById('signupSection');
const dashboardSection = document.getElementById('dashboardSection');

const loginBtnHeader = document.getElementById('loginBtnHeader');
const signupBtnHeader = document.getElementById('signupBtnHeader');
const showSignupLink = document.getElementById('showSignup');
const showLoginLink = document.getElementById('showLogin');
const emailLoginBtn = document.getElementById('emailLoginBtn');
const emailSignupBtn = document.getElementById('emailSignupBtn');
const googleLoginBtn = document.getElementById('googleLoginBtn');
const googleSignupBtn = document.getElementById('googleSignupBtn');
const logoutBtnHeader = document.getElementById('logoutBtnHeader');
const hamburgerMenu = document.getElementById('hamburgerMenu');
const navMenu = document.querySelector('.nav-menu');
const profileBtnHeader = document.getElementById('profileBtnHeader');
const loginEmail = document.getElementById('loginEmail');
const loginPassword = document.getElementById('loginPassword');
const signupEmail = document.getElementById('signupEmail');
const signupPassword = document.getElementById('signupPassword');
const loginLoading = document.getElementById('loginLoading');
const signupLoading = document.getElementById('signupLoading');
const loginError = document.getElementById('loginError');
const signupError = document.getElementById('signupError');
const userProfile = document.getElementById('userProfile');
const userAvatarHeader = document.getElementById('userAvatarHeader');
const userNameHeader = document.getElementById('userNameHeader');
const userDropdown = document.getElementById('userDropdown');
const userAvatarDashboard = document.getElementById('userAvatarDashboard');
const userNameDashboard = document.getElementById('userNameDashboard');
const userEmailDashboard = document.getElementById('userEmailDashboard');
const profileName = document.getElementById('profileName');
const profileGender = document.getElementById('profileGender');
const interestedDomain = document.getElementById('interestedDomain');
const saveProfileBtn = document.getElementById('saveProfileBtn');
const profileDisplaySection = document.getElementById('profileDisplaySection');
const profileEditSection = document.getElementById('profileEditSection');
const userAvatarPreview = document.getElementById('userAvatarPreview');
const profileImageInput = document.getElementById('profileImageInput');
const editProfileBtn = document.getElementById('editProfileBtn'); 
const tabButtons = document.querySelectorAll('.tab-btn');
const tabsContent = {
    profile: document.getElementById('profileTabContent'),
    courses: document.getElementById('coursesTabContent'),
    internships: document.getElementById('internshipsTabContent'),
};
const searchInput = document.getElementById('searchInput');


// --- Helper Functions (Defined after global elements for scoping) ---
function showSection(sectionElement) {
    if (!sectionElement) return;
    const parentModalContent = sectionElement.closest('.modal-content');
    if (parentModalContent) {
        parentModalContent.querySelectorAll('.auth-section').forEach(sec => sec.classList.remove('active'));
    }
    sectionElement.classList.add('active');
}
function showError(element, message) {
    if (!element) return;
    element.textContent = message;
    element.style.display = 'block';
    setTimeout(() => { element.style.display = 'none'; }, 5000);
}
function escapeHTML(str) {
    if (!str) return '';
    const div = document.createElement('div');
    div.appendChild(document.createTextNode(str));
    return div.innerHTML;
}
function handleImagePreview(event) {
    const file = event.target.files[0];
    if (file && userAvatarPreview) {
        const reader = new FileReader();
        reader.onload = (e) => { userAvatarPreview.src = e.target.result; };
        reader.readAsDataURL(file);
    }
}
function updateProfileUI(profileData) {
    const avatarUrl = profileData.photoUrl || '/images/no_image.png';
    const userName = profileData.name || 'User';

    // Desktop Header
    if (userAvatarHeader) userAvatarHeader.src = avatarUrl;
    if (userNameHeader) userNameHeader.textContent = userName.split(' ')[0];

    // Mobile Header (POINT 1)
    const userAvatarHeaderMobile = document.getElementById('userAvatarHeaderMobile');
    const userNameHeaderMobile = document.getElementById('userNameHeaderMobile');
    if (userAvatarHeaderMobile) userAvatarHeaderMobile.src = avatarUrl;
    if (userNameHeaderMobile) userNameHeaderMobile.textContent = 'My Profile'; // Keep as "My Profile" for mobile link text

    // Dashboard
    if (userAvatarDashboard) userAvatarDashboard.src = avatarUrl;
    if (userNameDashboard) userNameDashboard.textContent = userName;
    if (userEmailDashboard) userEmailDashboard.textContent = profileData.email;
    const genderDisplay = document.getElementById('profileGenderDisplay');
    const domainDisplay = document.getElementById('profileDomainDisplay');
    if (genderDisplay) genderDisplay.textContent = profileData.gender || 'Not specified';
    if (domainDisplay) domainDisplay.textContent = profileData.interestedDomain || 'Not specified';

    // Update edit form fields
    if (profileEditSection && !profileEditSection.classList.contains('hidden')) {
        if(profileName) profileName.value = profileData.name || '';
        if(profileGender) profileGender.value = profileData.gender || '';
        if(interestedDomain) interestedDomain.value = profileData.interestedDomain || '';
    }
}


// --- üîë AUTH & PROFILE LOGIC üîë ---

// Global function to show modal (used by course pages)
window.showLoginModal = function() {
    if(authModal) authModal.classList.add('active');
    if(loginSection) showSection(loginSection);
    document.body.style.overflow = 'hidden';
}

// Login function using Email and Password
async function handleEmailLogin(e) {
    e.preventDefault(); 
    if(loginLoading) loginLoading.style.display = 'block';
    if(loginError) loginError.textContent = ''; 
    const email = loginEmail.value;
    const password = loginPassword.value;
    if (!email || !password) {
        if(loginLoading) loginLoading.style.display = 'none';
        showError(loginError, 'Email aur Password bharna zaroori hai.');
        return;
    }
    try {
        await auth.signInWithEmailAndPassword(email, password);
        if(authModal) authModal.classList.remove('active');
        document.body.style.overflow = '';
    } catch (error) {
        let errorMessage = error.message;
        if (error.code === 'auth/wrong-password') {
             errorMessage = '‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§';
        } else if (error.code === 'auth/user-not-found') {
             errorMessage = '‡§Ø‡§π ‡§à‡§Æ‡•á‡§≤ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§';
        }
        if(loginError) showError(loginError, errorMessage);
        console.error("Login Error:", error.message);
    } finally {
        if(loginLoading) loginLoading.style.display = 'none';
    }
}

// Sign Up function using Email and Password
async function handleEmailSignup(e) {
    e.preventDefault(); 
    if(signupLoading) signupLoading.style.display = 'block';
    if(signupError) signupError.textContent = ''; 
    const email = signupEmail.value;
    const password = signupPassword.value;
    if (!email || !password) {
        if(signupLoading) signupLoading.style.display = 'none';
        showError(signupError, 'Email aur Password bharna zaroori hai.');
        return;
    }
    try {
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        // Initial profile creation (ensures data exists for initialization in listener)
        await db.collection('users').doc(userCredential.user.uid).set({
            email: email,
            name: userCredential.user.displayName || email.split('@')[0], 
            photoUrl: userCredential.user.photoURL || '/images/no_image.png',
            gender: '',
            interestedDomain: '',
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        }, { merge: true });
        if(authModal) authModal.classList.remove('active'); 
        document.body.style.overflow = '';
    } catch (error) {
        let errorMessage = error.message;
        if (error.code === 'auth/email-already-in-use') {
             errorMessage = '‡§Ø‡§π ‡§à‡§Æ‡•á‡§≤ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§ ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç‡•§';
        } else if (error.code === 'auth/weak-password') {
             errorMessage = '‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡§Æ‡§ú‡§º‡•ã‡§∞ ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ 6 ‡§Ø‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§µ‡§∞‡•ç‡§£‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§';
        }
        if(signupError) showError(signupError, errorMessage);
        console.error("Signup Error:", error.message);
    } finally {
        if(signupLoading) signupLoading.style.display = 'none';
    }
}

// --- EVENT LISTENERS ---
document.addEventListener('DOMContentLoaded', function() {
    // --- Auth Buttons & Modal Toggles ---
    if (loginBtnHeader) loginBtnHeader.addEventListener('click', (e) => { e.preventDefault(); if(authModal) window.showLoginModal(); });
    if (signupBtnHeader) signupBtnHeader.addEventListener('click', (e) => { e.preventDefault(); if(authModal) authModal.classList.add('active'); if(signupSection) showSection(signupSection); document.body.style.overflow = 'hidden'; });
    if (closeModalBtn) closeModalBtn.addEventListener('click', () => { if(authModal) authModal.classList.remove('active'); document.body.style.overflow = ''; });
    if (authModal) window.addEventListener('click', (e) => { if (e.target === authModal) { authModal.classList.remove('active'); document.body.style.overflow = ''; } });
    if (showSignupLink) showSignupLink.addEventListener('click', (e) => { e.preventDefault(); if(signupSection) showSection(signupSection); });
    if (showLoginLink) showLoginLink.addEventListener('click', (e) => { e.preventDefault(); if(loginSection) showSection(loginSection); });
    
    // --- Mobile Auth Button Logic (POINT 1) ---
    const loginBtnMobile = document.getElementById('loginBtnHeaderMobile');
    const signupBtnMobile = document.getElementById('signupBtnHeaderMobile');
    const profileBtnHeaderMobile = document.getElementById('profileBtnHeaderMobile');
    const logoutBtnHeaderMobile = document.getElementById('logoutBtnHeaderMobile');
    
    // Mobile Login Button
    if (loginBtnMobile) loginBtnMobile.addEventListener('click', (e) => { e.preventDefault(); if(authModal) window.showLoginModal(); if (hamburgerMenu && navMenu) { hamburgerMenu.classList.remove('active'); navMenu.classList.remove('active'); } });
    // Mobile Signup Button
    if (signupBtnMobile) signupBtnMobile.addEventListener('click', (e) => { e.preventDefault(); if(authModal) authModal.classList.add('active'); if(signupSection) showSection(signupSection); document.body.style.overflow = 'hidden'; if (hamburgerMenu && navMenu) { hamburgerMenu.classList.remove('active'); navMenu.classList.remove('active'); } });
    // Mobile Profile Button (open dashboard)
    if (profileBtnHeaderMobile) profileBtnHeaderMobile.addEventListener('click', () => { if(authModal) authModal.classList.add('active'); if(dashboardSection) showSection(dashboardSection); if (hamburgerMenu && navMenu) { hamburgerMenu.classList.remove('active'); navMenu.classList.remove('active'); } document.body.style.overflow = 'hidden'; const profileTabBtn = document.querySelector('.tab-btn[data-tab="profile"]'); if (profileTabBtn) profileTabBtn.click(); });
    
    const handleLogout = async () => { try { await auth.signOut(); if (hamburgerMenu && navMenu) { hamburgerMenu.classList.remove('active'); navMenu.classList.remove('active'); } if (authModal) authModal.classList.remove('active'); document.body.style.overflow = ''; } catch (error) { console.error('Logout error:', error); } };
    
    // Desktop Logout Button
    if (document.getElementById('logoutBtnHeader')) document.getElementById('logoutBtnHeader').addEventListener('click', handleLogout);
    // Mobile Logout Button
    if (logoutBtnHeaderMobile) logoutBtnHeaderMobile.addEventListener('click', handleLogout);
    
    // --- Auth Actions ---
    if (googleLoginBtn) googleLoginBtn.addEventListener('click', async () => { try { await auth.signInWithPopup(googleProvider); if(authModal) authModal.classList.remove('active'); document.body.style.overflow = ''; } catch (error) { if(loginError) showError(loginError, error.message); } });
    if (googleSignupBtn) googleSignupBtn.addEventListener('click', async () => { try { await auth.signInWithPopup(googleProvider); if(authModal) authModal.classList.remove('active'); document.body.style.overflow = ''; } catch (error) { if(signupError) showError(signupError, error.message); } });
    if (emailLoginBtn) emailLoginBtn.addEventListener('click', handleEmailLogin);
    if (emailSignupBtn) emailSignupBtn.addEventListener('click', handleEmailSignup);

    // --- User Dropdown & Navigation ---
    if (userProfile) userProfile.addEventListener('click', () => { if(userDropdown) userDropdown.classList.toggle('active'); });
    document.addEventListener('click', (e) => { if (userProfile && userDropdown && !userProfile.contains(e.target) && userDropdown.classList.contains('active')) userDropdown.classList.remove('active'); });
    if (profileBtnHeader) profileBtnHeader.addEventListener('click', () => { if(authModal) authModal.classList.add('active'); if(dashboardSection) showSection(dashboardSection); if(userDropdown) userDropdown.classList.remove('active'); document.body.style.overflow = 'hidden'; const profileTabBtn = document.querySelector('.tab-btn[data-tab="profile"]'); if (profileTabBtn) profileTabBtn.click(); });
    
    // --- Profile Editing ---
    if (editProfileBtn && profileDisplaySection && profileEditSection) { editProfileBtn.addEventListener('click', () => { profileDisplaySection.classList.add('hidden'); profileEditSection.classList.remove('hidden'); }); }
    if(profileImageInput && userAvatarPreview) { profileImageInput.addEventListener('change', handleImagePreview); }
    if (saveProfileBtn) saveProfileBtn.addEventListener('click', () => { const user = auth.currentUser; if (user) saveProfileData(user); });

    // --- Tab Switching Logic ---
    if (tabButtons.length > 0) {
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tab = button.dataset.tab;
                tabButtons.forEach(btn => btn.classList.remove('active'));
                Object.keys(tabsContent).forEach(key => {
                    const content = tabsContent[key];
                    if(content) content.classList.add('hidden');
                });
                button.classList.add('active');
                if (tabsContent[tab]) tabsContent[tab].classList.remove('hidden');

                // Re-render content upon tab switch
                if (tab === 'courses') {
                    db.collection(getUserPath('enrollments')).get().then(snapshot => {
                        const courses = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        renderCourseProgress(courses);
                    }).catch(err => console.error("Error fetching course data on tab switch:", err));
                } else if (tab === 'internships') {
                     db.collection(getUserPath('internships')).get().then(snapshot => {
                        const internships = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        renderInternshipHistory(internships);
                    }).catch(err => console.error("Error fetching internship data on tab switch:", err));
                }
            });
        });
        const profileTabBtn = document.querySelector('.tab-btn[data-tab="profile"]');
        if (profileTabBtn) profileTabBtn.classList.add('active');
    }
    
    // --- Global Scroll Animation for Header ---
     const headerElement = document.querySelector('header');
     if (headerElement) {
         window.addEventListener('scroll', function() {
             if (window.scrollY > 50) {
                 headerElement.classList.add('scrolled');
             } else {
                 headerElement.classList.remove('scrolled');
             }
         });
     }
});

console.log('üöÄ Internadda Script Loaded! (Firestore Real-Time Tracking Implemented)');
```</RFILE_EDIT>
